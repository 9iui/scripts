sudo tee /etc/elasticsearch/elasticsearch.yml > /dev/null <<'EOF'
cluster.name: elk-cluster
node.name: node-1
discovery.type: single-node

network.host: localhost
http.port: 9200

xpack.security.enabled: true
xpack.security.http.ssl:
  enabled: true
  keystore.path: certs/http.p12

xpack.security.transport.ssl:
  enabled: true
  verification_mode: certificate
  keystore.path: certs/transport.p12
  truststore.path: certs/transport.p12
EOF


sudo mkdir -p /var/log/elasticsearch
sudo chown -R elasticsearch:elasticsearch /var/log/elasticsearch
sudo chmod 750 /var/log/elasticsearch

sudo mkdir -p /var/lib/elasticsearch
sudo chown -R elasticsearch:elasticsearch /var/lib/elasticsearch
sudo chmod 750 /var/lib/elasticsearch


sudo systemctl daemon-reload
sudo systemctl restart elasticsearch

systemctl status elasticsearch --no-pager

curl --cacert /etc/elasticsearch/certs/http_ca.crt https://localhost:9200

















sudo -u elasticsearch /usr/share/elasticsearch/bin/elasticsearch \
  -Epath.conf=/etc/elasticsearch \
  -Epath.logs=/var/log/elasticsearch \
  -Epath.data=/var/lib/elasticsearch

sudo -u elasticsearch /usr/share/elasticsearch/bin/elasticsearch \
  -Epath.logs=/var/log/elasticsearch \
  -Epath.data=/var/lib/elasticsearch

sudo systemctl restart elasticsearch
sudo systemctl status elasticsearch --no-pager




